{"ast":null,"code":"import { defineComponent, ref, inject, watch, nextTick, onMounted, onUpdated, onBeforeUnmount, h, Fragment } from 'vue';\nimport '../../../utils/index.mjs';\nimport '../../../tokens/index.mjs';\nimport { elFormKey, elFormItemKey } from '../../../tokens/form.mjs';\nimport { addResizeListener, removeResizeListener } from '../../../utils/dom/resize-event.mjs';\nvar LabelWrap = defineComponent({\n  name: \"ElLabelWrap\",\n  props: {\n    isAutoWidth: Boolean,\n    updateAll: Boolean\n  },\n\n  setup(props, {\n    slots\n  }) {\n    const el = ref(null);\n    const elForm = inject(elFormKey);\n    const elFormItem = inject(elFormItemKey);\n    const computedWidth = ref(0);\n    watch(computedWidth, (val, oldVal) => {\n      if (props.updateAll) {\n        elForm.registerLabelWidth(val, oldVal);\n        elFormItem.updateComputedLabelWidth(val);\n      }\n    });\n\n    const getLabelWidth = () => {\n      var _a;\n\n      if ((_a = el.value) == null ? void 0 : _a.firstElementChild) {\n        const width = window.getComputedStyle(el.value.firstElementChild).width;\n        return Math.ceil(parseFloat(width));\n      } else {\n        return 0;\n      }\n    };\n\n    const updateLabelWidth = (action = \"update\") => {\n      nextTick(() => {\n        if (slots.default && props.isAutoWidth) {\n          if (action === \"update\") {\n            computedWidth.value = getLabelWidth();\n          } else if (action === \"remove\") {\n            elForm.deregisterLabelWidth(computedWidth.value);\n          }\n        }\n      });\n    };\n\n    const updateLabelWidthFn = () => updateLabelWidth(\"update\");\n\n    onMounted(() => {\n      addResizeListener(el.value.firstElementChild, updateLabelWidthFn);\n      updateLabelWidthFn();\n    });\n    onUpdated(updateLabelWidthFn);\n    onBeforeUnmount(() => {\n      var _a;\n\n      updateLabelWidth(\"remove\");\n      removeResizeListener((_a = el.value) == null ? void 0 : _a.firstElementChild, updateLabelWidthFn);\n    });\n\n    function render() {\n      var _a, _b;\n\n      if (!slots) return null;\n\n      if (props.isAutoWidth) {\n        const autoLabelWidth = elForm.autoLabelWidth;\n        const style = {};\n\n        if (autoLabelWidth && autoLabelWidth !== \"auto\") {\n          const marginWidth = Math.max(0, parseInt(autoLabelWidth, 10) - computedWidth.value);\n          const marginPosition = elForm.labelPosition === \"left\" ? \"marginRight\" : \"marginLeft\";\n\n          if (marginWidth) {\n            style[marginPosition] = `${marginWidth}px`;\n          }\n        }\n\n        return h(\"div\", {\n          ref: el,\n          class: [\"el-form-item__label-wrap\"],\n          style\n        }, (_a = slots.default) == null ? void 0 : _a.call(slots));\n      } else {\n        return h(Fragment, {\n          ref: el\n        }, (_b = slots.default) == null ? void 0 : _b.call(slots));\n      }\n    }\n\n    return render;\n  }\n\n});\nexport { LabelWrap as default };","map":null,"metadata":{},"sourceType":"module"}